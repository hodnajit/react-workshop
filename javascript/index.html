<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.6/handlebars.min.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" href="./style.css">
  <title>Document</title>
</head>
<body>
<div id="app"></div>

</body>
<script>
!function() {
function createDOM(document) {
  return ['div', 'span', 'label', 'input', 'button', 'form'].reduce(function(DOM, tag) {
    DOM[tag] = function(attrs, children) {
      var elem = document.createElement(tag)
      elem = Object.assign(elem, attrs)

      if (typeof children === 'string') {
        elem.appendChild(document.createTextNode(children))
      } else {
        children = children || []
        children.forEach(function(child) {
          var child = typeof child === 'string' ? document.createTextNode(child) : child
          elem.appendChild(child)
        })

        return elem
      }
    }

    return DOM
  }, {})
}

//API: DOM.div({ className: 'ahoj' }, [DOM.span({}, 'ahoj')]) -> <div class="ahoj"></div>
var DOM = createDOM(document)
var appElement = document.getElementById('app')

function renderDOM(DOM, elem) {
  elem.innerHTML = ''
  elem.appendChild(DOM)
}

var defaultData = {
  vars: [
    { name: 'text', type: 'text' },
    { name: 'droped', type: 'checkbox' },
    { name: 'options', type: [{ name: 'text', type: 'string' }] }
  ],
}


var formData = {}
function app(data) {
  function handleSubmit(e) {
    e.preventDefault()
    formData = $(e.target).serializeArray()
    console.log(formData)
  }

  return DOM.form({
    id: 'vars-form',
    onsubmit: handleSubmit,
  }, data.vars.map(function(varDeff) {
      return DOM.div({
        className: 'form-group',
      }, [
        DOM.label({}, [varDeff.name]),
        DOM.input(Object.assign({
          className: 'form-control',
        }, varDeff))
      ])
    }).concat([
      DOM.button({
        className: 'btn btn-success',
      }, ['Render'])
    ])
  )
}

renderDOM(app(defaultData), appElement)

}()
</script>
</html>
